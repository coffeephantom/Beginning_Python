# 即时标记

## 概述
即时标记是python基础教程中的第一个项目，主要是针对Python文本处理能力的练习。个人感觉像是写一个小小的markdown一样,主要根据一些简单的标记记号, 为纯文本添加格式.

## 明确问题
如何为纯文本添加一些格式？先来分析一下这个问题，在没有看书之前，估计我应该是想不到如何去考虑解决这个问题的，但是参考书中内容之后，觉得应该尝试一下自己来简化，或者分析这个问题，来锻炼一下自己的思维习惯。有的时候写不出脚本或者写不出小程序，从根本而言还是对问题的分析没有到位，所以先看看能否与已经了解的东西联系起来。

自我的思考（还是有参考书本，并不是完全独立思考出来的，应该还需要加强）

- 程序的输入输出：
输入：纯文本（存储的类型可能是：字符串），在python当中，可以将字符串与list等进行转化
输出：带格式的文本（存储的类型可能是：字符串）

- 如何判断文本当中哪些地方应该添加格式
输出的纯文本并不能全部是都是无规律的文字，可能需要用户做一定的预处理，所以需要定一系列的规则来判断，比如总共有哪几种类型的格式，在输入的纯文本文中是已什么方式表现出来的等。

- 如何添加格式
格式的代表是怎样的？这个应该和程序的输出有关，假如需要输出一个html文件，那么可以通过增加一些标签来区分不同的格式。


书中也给出了一些思路
> 在开始编写原型之前，先定义一些目标。

> * 输入不应该包含人工代码或者标签

> * 你应该能处理不同的块(block)，比如标题、段落、列表项、内嵌文本（比如被强调的文本和URL）

> * 尽管这个实现处理的HTML， 但把它扩展到其他标记语言应该也很容易

## 考虑实现

### 工具
工欲善其事必先利其器， 要实现即时标记的功能，针对python而言可能会用到的针对文件的处理，比如读入、输出文件，需要搜索定位文本，可能需要用到正则表达模块等。

书中提到的工具：

> * 需要对文件进行读写，或者至少从标准输入读取（sys.stdin），利用print输出

> * 需要对所出入的行进行迭代

> * 需要一些字符串方法

> * 需要一个或者两个生成器

> * 可能还需要用到re模块

### 准备

准备测试文档， 测试文档为text_input.txt

## Version 1.0 (初次实现)

1.文本块的获取 

总体思路还是先采取书中所说。
自己最初的想法:
生成器之类的的什么还不是很熟，目前先想法采用已经掌握的内容。在util.py依然写两个函数，一个用来获取文件中的行，一个则将行重新组合成文本块。
目前观察测试块与块之前都有一个空行，空行势必有换行符出现，因此初步考虑将行组合后，利用'\n\n'作为分隔符重新生成列表
教程中则采用了行生成器与文件块生成器的方法。其中用到了yield, 也通过这个机会更加了解一下python中的生成器(参考网站： http://pyzh.readthedocs.org/en/latest/the-python-yield-keyword-explained.html ), 任何包含yield的函数称之为生成器, yield有点与return类似。但与return不同的是，yield返回一个迭代对象，函数内的代码并未马上执行。当使用for访问这个函数时，函数中的代码才被执行。yield会产生多个值， 每次产生一个值，函数就会暂停并等待下次激活。教程中的总结还是非常好的：
> 生成器是一个包含yield关键字的函数，当它被调用时，在函数体中的代码不会被执行，而是会返回一个迭代器。每次请求一个值就会执行生成器中的代码直到遇到一个yield或者return语句。yield意味应该生成一个值， return意味着生成器停止（只有在生成器中可以进行无参调用）。

可以帮助理解的代码：

    simple_list = [1, 2, 3, 4, 5]

    def gen_sec(l):
        for index in range(len(l)):
            yield l[index]

    a = gen_sec(simple_list)

    it = iter(a)

    print "get by next method: %d" % (it.next())

    print "get by next method: %d" % (it.next())


    for i in a:
        print "print by for: %d" % (i)

运行结果：
    
    get by next method: 1
    get by next method: 2
    print by for: 3
    print by for: 4
    print by for: 5



2.文本的标记

目前定为输出的文件为html文件，基本思路是直接在内容中插入html的基本标签，simple_markup.py中包含两个函数， 一个是标记函数，一个是输出函数，标记函数是通过一些特定的输入（比如*号）来匹配需要进行标记的文本，并且添加相应标签。输出函数则是将标记完的内容写入新的文件。simple_markup2.py中是教程中实现的方法，通过读取系统标准输入中的内容，并把html文件打印出来。它需要通过命令python simple_markup2.py < text_input.txt > text_output.html运行来生成html文件，即将text_input.txt作为标准输入读取，在标准输出中的内容重定向只html文件。


## Version 2.0 再次实现

这部分稍微有些难度，如果不看教程至少不一定能抽象出它所提到的几个模块：
> *语法分析器*：一个读取文本，管理其他类的对象

> *规则*: 可以为每个种类的块制定一条规则，规则能检测使用的块类型并且进行适当的格式化。

> *过滤器*:使用过滤器来包装一些处理内嵌元素的正则表达式。

> *处理程序* 语法分析器使用处理程序来产生输出。每个处理程序能产生不同种类的标记。

### 处理程序

处理程序主要用以标记文本，即主要用来再文本块前后添加上诸如`<h1></h1>`之类的标签。从Version 2.0开始，基本上就会按照教程中所说的方法进行学习。

### 规则

规则模块主要是用于确定文本块的类型，以便能够调用合适的处理方法

### 过滤器

此处主要是正则规则，将正则关系与类型想对应，使得过滤器在过滤文本后能正确确定文本快的类型，从而为后续调用添加标签方法打下基础。

### 语法分析器

语法分析器是整个小程序的核心部分，它主要用于读取系统标准输入中的文件内容，同时根据所添加的规则和过滤器识别文本，并根据过滤规则处理文本内容。